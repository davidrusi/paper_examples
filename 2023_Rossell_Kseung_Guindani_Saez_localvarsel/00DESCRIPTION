This folder contains R code to reproduce the examples in the paper "Semi-parametric local variable selection under misspecification" by Rossell et al (2023)

If you just want a quick intro on how to use mombf to do variable selection see

- example.qmd (or its compiled version example.html): an example with independent errors
- example_fda.qmd (or its .html compiled version): an example with functional data analysis

Regarding reproducing the paper's results,  the relevant files are below:

- figure1.R: reproduces the plots in Figure 1 and related supplementary figures

- simulation_iid.R: reproduces Section 5.1 "Simulation with independent errors"

- simulation_fda.R: reproduces Section 5.2 "Functional data simulation"

- Directory lfmm: code implementing the LFMM method, obtained from https://doi.org/10.1214/23-BA1383SUPPB. For details about the method see Paulon, Sarkar & Mueller (2023), Bayesian Semiparametric Hidden Markov Tensor Models for Time Varying Random Partitions with Local Variable Selection, Bayesian Analysis. DOI: 10.1214/23-BA1383

- salary.R: reproduces Section 5.3 "Salary gaps versus age"

- salary.RData: dataset used in Section 5.3

- EcoG_analysis.R: reproduces Section 5.4 on the brain activation data of Saez et al.

- ocf3_prewindowed.RData: brain activation dataset
